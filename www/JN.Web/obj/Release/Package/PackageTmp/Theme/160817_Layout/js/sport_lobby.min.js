var newSport={winActivity:"focus",timer:1,latest_data:[],latest_league:[],latest_gid:0,live_data:[],live_gid:0,coming_data:[],coming_gid:0,web_layout:$("html"),slider_data:[],slider_width:{960:"",900:"",682:""},sliderBox:$(".ele-ball-slider"),sliderTarget:$("#ball-slideshow"),slideShowDelay:5e3,slideTimes:{},olympicEST:"",olympic_data:[],olympic_index:0,init:function(){newSport.wagersAjax(),newSport.latestResultsAjax(newSport.update_latest_html),newSport.liveNewestAjax(newSport.update_live_html),newSport.liveComingAjax(newSport.update_coming_html),newSport.sliderAjax(newSport.update_slider_html),newSport.olympicAjax(newSport.update_olympic_html),newSport.showLoginWrap(),newSport.quickLinks(),function(e){e.fn.hasScrollBar=function(){return this.get(0).scrollHeight>this.get(0).clientHeight}}(jQuery),$(window).resize(function(){newSport.setPic()}),$(window).blur(function(){newSport.winActivity="blur"}),$(window).focus(function(){newSport.winActivity="focus"}),setInterval(newSport.counter,1e3)},counter:function(){"focus"===newSport.winActivity&&(newSport.timer%120==0&&newSport.wagersAjax(),newSport.timer%300==0&&newSport.latestResultsAjax(),newSport.timer%30==0&&newSport.liveNewestAjax(),newSport.timer%60==0&&newSport.liveComingAjax(),newSport.timer%8==0&&(newSport.update_latest_html(),newSport.olympic_data.length>4&&newSport.update_olympic_html()),newSport.timer%15==0&&(newSport.update_live_html(),newSport.update_coming_html()),newSport.timer++)},showLoginWrap:function(){$(".ele-member-wagers").on("click",".wagers-login-btn",function(){loginWrap.showUp()})},quickLinks:function(){$(".ele-member-wagers").on("click",".wagers-sport-btn",function(){newSport.fullScreenOpen("/sport/")}),$("#js-olympic-news-btn").on("click",function(){newSport.fullScreenOpen("/sport/?area=2")}),$(".ele-latest-results").on("click",".card-link",function(){newSport.fullScreenOpen("/sport/?page=game_result&game_type=FT")}),$(".ele-rolling-wrap").on("click",".card-link",function(){newSport.fullScreenOpen("/sport/?page=odds_today&game_type=FT")}),$(".ele-comming-wrap").on("click",".card-link",function(){newSport.fullScreenOpen("/sport/?page=odds_today&game_type=FT")}),$("#league-data, #wide-league-data").on("click",".league-content",function(){newSport.fullScreenOpen("/sport/?page=game_result&game_type="+$(this).data("gtype"))}),$("#newest-data").on("click",".live-sport-link",function(){newSport.fullScreenOpen("/sport/?page=odds_live&game_id="+$(this).data("gid"))}),$("#coming-data").on("click",".live-sport-link",function(){newSport.fullScreenOpen("/sport/?page=odds_today&game_type="+$(this).data("gtype")+"&game_id="+$(this).data("gid"))})},fullScreenOpen:function(e){window.open(e,"bbSport")},wagersAjax:function(){$.ajax({method:"GET",url:"/infe/rest/game/sport/getMemberWagers.json",dataType:"json",cache:!1}).done(function(e){void 0!=e.status&&"Y"===e.status&&($("#js-settled-num").text(e.data.settled?e.data.settled:"0"),$("#js-unsettled-num").text(e.data.unsettled?e.data.unsettled:"0"))})},latestResultsAjax:function(e){$.ajax({method:"GET",url:"/infe/rest/game/sport/getResultNewest.json",dataType:"json",cache:!1}).done(function(t){void 0!=t.status&&"Y"===t.status&&(newSport.latest_data=t.data.game_list,newSport.latest_league=t.data.league,void 0!=e&&e())})},update_latest_html:function(){var e,t="",i="",a=2,n=$("#league-data"),s=newSport.latest_data;if(0===s.length)return n.html(t),!1;void 0==s[newSport.latest_gid]&&(newSport.latest_gid=0);for(var o=0;a>o;o++)void 0!=s[newSport.latest_gid]&&(e=s[newSport.latest_gid].game_type,i+=newSport.leagueHtmlInner(s[newSport.latest_gid]),newSport.latest_gid++);t+='<div class="latest-inner-box">'+i+"</div>",0==$(".latest-inner-box").length?n.html(t):(n.append(t),n.animate({top:"-186px"},1500,function(){n.find(".latest-inner-box:first-child").remove(),n.css("top",0)}))},leagueHtmlInner:function(e){var t,i=""==e.status?e.score_h+"&nbsp;:&nbsp;"+e.score_a:e.status,a=""!=e.status?e.status:"",n="Y"==e.midfield?e.team_h+"["+S_MEDIUM+"]":e.team_h,s=e.league_id,o=newSport.latest_league;return t=o[s]?o[s]:"",'<div class="league-inner-box"><div class="league-title clearfix"><i class="game-type-icon '+e.game_type+'"></i><span class="latest-date">'+e.game_day+'</span><span class="league-name" title="'+t+'">'+t+'</span></div><a href="###" data-gtype="'+e.game_type+'" class="league-content clearfix"><span class="league-status" title="'+a+'">'+i+'</span><span class="league-team"><span class="league-team-name" title="'+n+'">'+n+'</span><span class="league-team-name team-a" title="'+e.team_a+'">'+e.team_a+"</span></span></a></div>"},setTypeName:function(e){switch(e){case"FT":cur_type_name=S_FT;break;case"BK":cur_type_name=S_BK;break;case"FB":cur_type_name=S_FB;break;case"IH":cur_type_name=S_IH;break;case"TN":cur_type_name=S_TN;break;case"BS":cur_type_name=S_BS;break;case"SP":cur_type_name=S_SP;break;case"F1":cur_type_name=S_OTHER;break;default:cur_type_name=""}},liveNewestAjax:function(e){$.ajax({method:"GET",url:"/infe/rest/game/sport/getOddsLiveNewest.json",dataType:"json",cache:!1}).done(function(t){void 0!=t.status&&"Y"===t.status&&(newSport.live_data=t.data,void 0!=e&&e())})},update_live_html:function(){var e,t="",i="",a=$("#newest-data"),n=2,s=newSport.live_data;if(0===s.length)return t='<div class="non-rolling-status"><span class="non-rolling-text"><span class="width-align" title="'+S_NO_LIVE_EVENTS+'">'+S_NO_LIVE_EVENTS+'</span></span><img class="non-rolling-pic" src="/cl/tpl/template/images/sportLobby/icon_whistle.png" alt="" width="73px" height="59px" /></div>',a.html(t),!1;void 0==s[newSport.live_gid]&&(newSport.live_gid=0),e=s[newSport.live_gid].game_type;for(var o=0;n>o;o++)void 0!=s[newSport.live_gid]&&e==s[newSport.live_gid].game_type&&(i+=newSport.liveHtmlInner(s[newSport.live_gid]),newSport.live_gid++);newSport.setTypeName(e),t+='<div class="live-inner-box"><div class="live-inner"><div class="game-type"><i class="game-type-icon '+e+'"></i><div class="live-game-name">'+cur_type_name+"</div></div>"+i+"</div></div>",0==$("#newest-data .live-inner-box").length?a.html(t):(a.prepend(t),a.find(".live-inner-box:last-child").fadeOut(800,function(){a.find(".live-inner-box:last-child").remove()}))},liveHtmlInner:function(e){var t,i,a,n,s,o,l,d="BK"==e.game_type||"TN"==e.game_type||"FB"==e.game_type?" color-change":"",r="H"===e.strong&&""!==e.odds[0]&&0!==e.odds[0]?" live-strong":"",p="C"===e.strong&&""!==e.odds[1]&&0!==e.odds[1]?" live-strong":"",c=e.odds[2]<0?" odds-strong":"",_=e.odds[3]<0?" odds-strong":"";return 1==e.midfield?"BS"===e.game_type&&void 0!==e.pit_h&&""!==e.pit_h?(n=e.tid_h+"["+S_MEDIUM+"]["+e.pit_h+"]",o=e.tid_h+"["+S_MEDIUM+']<span class="pitcher-name">['+e.pit_h+"]</span>"):(n=e.tid_h+"["+S_MEDIUM+"]",o=n):"BS"===e.game_type&&void 0!==e.pit_h&&""!==e.pit_h?(n=e.tid_h+"["+e.pit_h+"]",o=e.tid_h+'<span class="pitcher-name">['+e.pit_h+"]</span>"):(n=e.tid_h,o=n),"BS"===e.game_type&&void 0!==e.pit_a&&""!==e.pit_a?(s=e.tid_a+"["+e.pit_a+"]",l=e.tid_a+'<span class="pitcher-name">['+e.pit_a+"]</span>"):(s=e.tid_a,l=s),"FT"==e.game_type?(t="mid"==e.game_start_time?S_MID_TIME:e.game_start_time+'"',i=e.score_h+"&nbsp;:&nbsp;"+e.score_a):"IH"==e.game_type||"BS"==e.game_type||"F1"==e.game_type?(t="Live",i=e.score_h+"&nbsp;:&nbsp;"+e.score_a):"BK"==e.game_type||"TN"==e.game_type||"FB"==e.game_type?(t=e.game_time,i=S_IN_LIVE):(t="",i=""),a='<div class="live-sport-link" data-gid="'+e.game_id+'"><div class="live-game-title clearfix"><div class="live-game-league" title="'+e.lid_name+'">'+e.lid_name+'</div><div class="live-game-odds">'+S_R+'</div></div><div class="live-game-content clearfix"><div class="content-left-area"><div class="live-game-sec'+d+'">'+t+'</div><div class="live-game-score'+d+'">'+i+'</div></div><div class="content-right-area"><div class="live-game-info clearfix"><div class="live-team-name'+r+'" title="'+n+'">'+o+'</div><div class="live-odds-score live-odds-head">'+e.odds[0]+'</div><div class="live-odds-score'+c+'">'+e.odds[2]+'</div></div><div class="live-game-info live-guest-info clearfix"><div class="live-team-name'+p+'" title="'+s+'">'+l+'</div><div class="live-odds-score live-odds-head">'+e.odds[1]+'</div><div class="live-odds-score'+_+'">'+e.odds[3]+"</div></div></div></div></div>"},liveComingAjax:function(e){$.ajax({method:"GET",url:"/infe/rest/game/sport/getOddsLiveComingSoon.json",dataType:"json",cache:!1}).done(function(t){void 0!=t.status&&"Y"===t.status&&(newSport.coming_data=t.data,void 0!=e&&e())})},update_coming_html:function(){var e,t="",i="",a=$("#coming-data"),n=2,s=newSport.coming_data;if(0===s.length)return t='<div class="non-rolling-status"><span class="non-rolling-text"><span class="width-align" title="'+S_NO_UPCOMING_EVENTS+'">'+S_NO_UPCOMING_EVENTS+'</span></span><img class="non-rolling-pic" src="/cl/tpl/template/images/sportLobby/icon_whistle.png" alt="" width="73px" height="59px" /></div>',a.html(t),!1;void 0==s[newSport.coming_gid]&&(newSport.coming_gid=0),e=s[newSport.coming_gid].game_type;for(var o=0;n>o;o++)void 0!=s[newSport.coming_gid]&&e==s[newSport.coming_gid].game_type&&(i+=newSport.comingHtmlInner(s[newSport.coming_gid]),newSport.coming_gid++);newSport.setTypeName(e),t+='<div class="live-inner-box"><div class="live-inner"><div class="game-type"><i class="game-type-icon '+e+'"></i><div class="live-game-name">'+cur_type_name+"</div></div>"+i+"</div></div>",0==$("#coming-data .live-inner-box").length?a.html(t):(a.prepend(t),a.find(".live-inner-box:last-child").fadeOut(800,function(){a.find(".live-inner-box:last-child").remove()}))},comingHtmlInner:function(e){var t,i,a,n,s,o=/-(\d.*)/.exec(e.game_date)[1],l="H"===e.strong&&""!==e.odds[0]&&0!==e.odds[0]?" live-strong":"",d="C"===e.strong&&""!==e.odds[1]&&0!==e.odds[1]?" live-strong":"",r=e.odds[2]<0?" odds-strong":"",p=e.odds[3]<0?" odds-strong":"";return 1==e.midfield?"BS"===e.game_type&&void 0!==e.pit_h&&""!==e.pit_h?(i=e.tid_h+"["+S_MEDIUM+"]["+e.pit_h+"]",n=e.tid_h+"["+S_MEDIUM+']<span class="pitcher-name"['+e.pit_h+"]</span>"):(i=e.tid_h+"["+S_MEDIUM+"]",n=i):"BS"===e.game_type&&void 0!==e.pit_h&&""!==e.pit_h?(i=e.tid_h+"["+e.pit_h+"]",n=e.tid_h+'<span class="pitcher-name">['+e.pit_h+"]</span>"):(i=e.tid_h,n=i),"BS"===e.game_type&&void 0!==e.pit_a&&""!==e.pit_a?(a=e.tid_a+"["+e.pit_a+"]",s=e.tid_a+'<span class="pitcher-name">['+e.pit_a+"]</span>"):(a=e.tid_a,s=a),t='<div class="live-sport-link" data-gtype="'+e.game_type+'" data-gid="'+e.game_id+'"><div class="live-game-title clearfix"><div class="live-game-league" title="'+e.lid_name+'">'+e.lid_name+'</div><div class="live-game-odds">'+S_R+'</div></div><div class="live-game-content clearfix"><div class="content-left-area"><div class="coming-game-date">'+o+'</div><div class="coming-game-sec">'+e.game_time+'</div></div><div class="content-right-area"><div class="live-game-info clearfix"><div class="live-team-name'+l+'" title="'+i+'">'+n+'</div><div class="live-odds-score live-odds-head">'+e.odds[0]+'</div><div class="live-odds-score'+r+'">'+e.odds[2]+'</div></div><div class="live-game-info live-guest-info clearfix"><div class="live-team-name'+d+'" title="'+a+'">'+s+'</div><div class="live-odds-score live-odds-head">'+e.odds[1]+'</div><div class="live-odds-score'+p+'">'+e.odds[3]+"</div></div></div></div></div>"},sliderAjax:function(e){$.ajax({method:"GET",url:"/infe/rest/webmgnt/sportRotate.json",dataType:"json",cache:!1}).done(function(t){void 0!=t&&(newSport.slider_data=t,void 0!=e&&e())})},update_slider_html:function(){for(var e="",t=newSport.slider_data,i=0,a=t.length;a>i;i++)e+='<li><a class="slider-pic" '+t[i].link+'><img src="'+t[i].image+'" width="100%" height="100%" ></a></li>',newSport.slideTimes[i]=1e3*t[i].delay;newSport.sliderTarget.html(e),newSport.setPic(),newSport.startSliderShow()},setPic:function(){var e=newSport.web_layout.hasScrollBar()?$(window).width()+17:$(window).width(),t=e>=960?"960":960>e&&e>682?"900":"682",i=newSport.sliderBox.width();""==newSport.slider_width[t]&&(newSport.slider_width[t]=238*i/682),newSport.sliderBox.css("height",newSport.slider_width[t])},startSliderShow:function(){newSport.sliderTarget.anythingSlider({mode:"fade",autoPlay:!0,autoPlayLocked:!0,buildArrows:!1,buildStartStop:!1,buildNavigation:!0,expand:!0,resizeContents:!0,navigationFormatter:function(){return""},delay:newSport.slideTimes[0],onSlideBegin:function(e,t){t.clearTimer(!0),t.startStop(!0)},onSlideComplete:function(e){e.clearTimer(!0),newSport.slideTimes.hasOwnProperty(e.currentPage-1)?e.options.delay=newSport.slideTimes[e.currentPage-1]:e.options.delay=newSport.slideShowDelay,e.startStop(!0)}})},olympicAjax:function(){$.ajax({method:"GET",url:"/cl/js/sportLobby/olympic_news.json",dataType:"json",cache:!1}).done(function(e){estObj.dispTime();var t,i,a=["zh-tw","zh-cn","en"],n=Date.parse(newSport.olympicEST).valueOf(),s=newSport.olympicEST.getDate(),o="",l="",d="",r=[],p=0;if(-1===a.indexOf(lang)&&"ug"!==lang?lang="en":"ug"===lang&&(lang="zh-tw"),n<=Date.parse("2016/08/05 00:00:00").valueOf()?t=e["0805_before"][lang]:n>Date.parse("2016/08/05 00:00:00").valueOf()&&n<Date.parse("2016/08/06 00:00:00").valueOf()?t=e["0805_after"][lang]:n>Date.parse("2016/08/21 00:00:00").valueOf()?t=e["0821"][lang]:(o=s,l=s-1,10>o&&(o="0"+o),10>l&&(l="0"+l),d="2016/08/"+o+" 00:00:00",t=n<=Date.parse(d).valueOf()?e["08"+l][lang]:e["08"+o][lang]),i=t.length,4>=i){for(var c=0;i>c;c++)r.push("<p title='"+t[c]+"'>"+t[c]+"</p>");$(".js-news-text").eq(0).append(r.join(""))}else{i%4!==0&&(p=Math.floor(i/4));for(var c=0;i>c;c++)r.push("<p title='"+t[c]+"'>"+t[c]+"</p>"),c%4===3?(newSport.olympic_data.push(r),r=[]):0!==p&&p===i&&newSport.olympic_data.push(r);$(".js-news-text").eq(0).append(newSport.olympic_data[0].join(""))}})},update_olympic_html:function(){var e=newSport.olympic_data,t=newSport.olympic_index,i=e.length,a=$("#js-olympic-news-text"),n=[],s=[];n=e[t+1],s=e[t+2],t===i-3?s=e[0]:t===i-2?s=e[1]:t===i-1&&(n=e[0],s=e[2]),$(".js-news-text").html("").eq(1).append(n.join("")),a.animate({top:"-88px"},1500,function(){$(".js-news-text").eq(0).html("").append(s.join("")),$(".news-text").eq(0).appendTo(a),a.css("top",0)}),t===i-1?newSport.olympic_index=0:newSport.olympic_index++}};newSport.init();
